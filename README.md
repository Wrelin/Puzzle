Puzzle validator v2
with stacks